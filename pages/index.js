import Head from "next/head";
import Image from "next/image";
import { Button, Header, TopTracks } from "../components";
import { useState, useEffect } from "react";
import useUser from "../hooks/use-user";
import Container from "../components/Container";

export default function Home() {
  const [user, fetchUser] = useState(null);

  const { data, isLoading } = useUser();
  const songs = user ? user.tracks : data?.tracks;

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Container
        as="main"
        css={{
          padding: "1rem",
        }}
      >
        <Header user={user} isLoading={isLoading} />
        <Button fetchUser={fetchUser} />
        {isLoading ? (
          "loading..."
        ) : (
          <>
            <TopTracks songs={songs} />
          </>
        )}
      </Container>
    </>
  );
}
